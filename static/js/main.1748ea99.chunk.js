(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{203:function(e,t,r){},205:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(19),s=r.n(o),i=(r(84),r(9)),c=r(10),l=r(12),p=r(11),u=r(13),h=r(29),m=r.n(h),d=r(44),b=r(28),g=r(20),f=r(2),w=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.treeIds,r=this.props.treeDict;return a.a.createElement(g.b,{type:"symbol",id:"trees",layout:{"icon-image":"billy"}},t.map(function(t){return a.a.createElement(g.a,{onMouseEnter:e.props.onTreeHover.bind(e,t),onMouseLeave:e.props.onTreeEndHover.bind(e),coordinates:r[t].geometry.coordinates,onClick:e.props.onTreeClick.bind(null,t),key:t})}))}}]),t}(n.Component),v=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.hoveredTree,t=this.props.onPopUpClick;return a.a.createElement(g.c,{key:e.recordid,coordinates:e.geometry.coordinates,offset:15,onClick:t},a.a.createElement("div",null,a.a.createElement("h3",null,e.fields.libellefrancais),a.a.createElement("div",null,"Esp\xe8ce : ",e.fields.espece),a.a.createElement("div",null,"Genre : ",e.fields.genre),e.fields.dateplantation?a.a.createElement("div",null," Ann\xe9e de plantation : ",e.fields.dateplantation.substr(0,4)," "):null))}}]),t}(n.Component),k=r(78),D=r(47),j=r.n(D),y=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes;return a.a.createElement("div",null,a.a.createElement(j.a,{open:this.props.leftDrawer,onClose:this.props.toggleDrawer},a.a.createElement("div",{tabIndex:0,role:"button",onClick:this.props.toggleDrawer,onKeyDown:this.props.toggleDrawer})),a.a.createElement(j.a,{anchor:"bottom",open:this.props.bottomDrawer,onClose:this.props.toggleDrawer},a.a.createElement("div",{tabIndex:0,role:"button",onClick:this.props.toggleDrawer,onKeyDown:this.props.toggleDrawer},a.a.createElement("div",{className:e.wikiRow},a.a.createElement("img",{className:e.treeImg,src:this.props.thumbnailUrl,alt:"Wiki Thumbnail"})),a.a.createElement("div",{className:e.wikiTextContainer},a.a.createElement("p",null,this.props.wikiDesc)))))}}]),t}(a.a.Component),O=Object(k.withStyles)({list:{width:250},fullList:{width:"auto"},treeImg:{marginTop:10,marginBottom:10,marginRight:10,width:100,display:"inlineBlock",float:"left"},wikiRow:{marginLeft:10,marginRight:10},wikiTextContainer:{marginLeft:10,marginRight:10}})(y),E=r(48),T=Object(g.d)({minZoom:11,maxZoom:16,accessToken:E.b}),x=E.a,C={speed:.6},I=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(l.a)(this,Object(p.a)(t).call(this,e))).onMapLoad=function(e){e.addControl(new f.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!1}))},r.onTreeHover=function(e,t){t.map.getCanvas().style.cursor="pointer",r.setState({hoveredTreeID:e})},r.onTreeEndHover=function(e){e.map.getCanvas().style.cursor="",r.setState({hoveredTreeID:""})},r.onTreeClick=function(e){r.setState({hoveredTreeID:e,bottomDrawer:!0});var t=r.state.treeDict[e].fields.libellefrancais,n=r.state.treeDict[e].fields.genre,a=t+" "+r.state.treeDict[e].fields.espece+" "+n;console.log("species",a),r.wikiTreeData(n)},r.onPopUpClick=function(){r.setState({hoveredTreeID:""})},r.toggleDrawer=function(){r.setState({bottomDrawer:!1,thumbnailUrl:"",wikiDesc:""})},r.TreeData=Object(d.a)(m.a.mark(function e(){var t,n,a,o,s;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,fetch("https://opendata.paris.fr/api/records/1.0/search/?dataset=arbresremarquablesparis&rows=200");case 3:return n=e.sent,e.next=6,n.json();case 6:for(a=e.sent,o=Math.min(a.parameters.rows,a.nhits),s=0;s<o;s++)t.push(s);return e.abrupt("return",r.setState({treeDict:a.records,nbTrees:o,treeIds:t},function(){console.log("dict",this.state.treeDict),console.log("nb",this.state.nbTrees),console.log("ids",this.state.treeIds)}));case 10:case"end":return e.stop()}},e,this)})),r.wikiTreeData=function(){var e=Object(d.a)(m.a.mark(function e(t){var n,a,o,s,i,c,l,p,u,h,d,b,g;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(" ").join("%20"),e.next=3,fetch("https://fr.wikipedia.org/w/api.php?action=opensearch&search=".concat(n,"&format=json&redirects=resolve&origin=*"));case 3:return a=e.sent,e.next=6,a.json();case 6:return o=e.sent,console.log("Search response Json",o),e.next=10,o[3][0];case 10:return s=e.sent,console.log("Best result",s),e.next=14,s.split("/").slice(-1)[0];case 14:return i=e.sent,console.log("Best result title",i),c="",e.prev=17,e.next=20,fetch("https://fr.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&exintro&explaintext&redirects=1&titles=".concat(i,"&origin=*"));case 20:return l=e.sent,e.next=23,l.json();case 23:return p=e.sent,console.log("descQuery Json",p),e.next=27,p.query.pages;case 27:return u=e.sent,console.log("Pages",u),e.next=31,u[Object.keys(u)[0]].extract;case 31:c=e.sent,console.log("desc",c),e.next=38;break;case 35:e.prev=35,e.t0=e.catch(17),console.log("desc error",e.t0);case 38:return h="",e.prev=39,e.next=42,fetch("https://fr.wikipedia.org/w/api.php?action=query&prop=pageimages&titles=".concat(i,"&format=json&pithumbsize=200&origin=*"));case 42:return d=e.sent,e.next=45,d.json();case 45:return b=e.sent,console.log("thumbQuery Json",b),e.next=49,b.query.pages;case 49:return g=e.sent,console.log("Pages",g),e.next=53,g[Object.keys(g)[0]].thumbnail.source;case 53:h=e.sent,console.log("Thumbnail",h),e.next=60;break;case 57:e.prev=57,e.t1=e.catch(39),console.log("thumbnail error",e.t1);case 60:return e.abrupt("return",r.setState({wikiDesc:c,thumbnailUrl:h},function(){console.log("wikiData",this.state.thumbnailUrl)}));case 61:case"end":return e.stop()}},e,this,[[17,35],[39,57]])}));return function(t){return e.apply(this,arguments)}}(),r.state={treeDict:"",nbTrees:0,treeIds:[],hoveredTreeID:"",mapCenter:[2.3466110229492188,48.85613168160397],zoom:[12],leftDrawer:!1,bottomDrawer:!1,wikiTreeData:"",thumbnailUrl:"",wikiDesc:""},r.toggleDrawer=r.toggleDrawer.bind(Object(b.a)(Object(b.a)(r))),r}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.TreeData()}},{key:"render",value:function(){var e=this.state.hoveredTreeID,t=this.state.mapCenter,r=this.state.zoom;return a.a.createElement("div",null,a.a.createElement(T,{onStyleLoad:this.onMapLoad,style:x,center:t,containerStyle:{width:"100vw",height:"100vh"},flyToOptions:C,zoom:r},a.a.createElement(w,{onTreeHover:this.onTreeHover,onTreeEndHover:this.onTreeEndHover,treeIds:this.state.treeIds,treeDict:this.state.treeDict,onTreeClick:this.onTreeClick}),e&&a.a.createElement(v,{hoveredTree:this.state.treeDict[e],onPopUpClick:this.onPopUpClick})),a.a.createElement(O,{wikiDesc:this.state.wikiDesc,thumbnailUrl:this.state.thumbnailUrl,leftDrawer:this.state.leftDrawer,bottomDrawer:this.state.bottomDrawer,toggleDrawer:this.toggleDrawer}))}}]),t}(n.Component),S=(r(203),function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(O,null),a.a.createElement(I,null))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},48:function(e){e.exports={b:"pk.eyJ1IjoiaGlwcG9seXRlaiIsImEiOiJjamdub2g0cmoyMjZyMndzN3I2eGd4Y3Y3In0.weVb9EjRtuH1lSMFAOqcCA",a:"mapbox://styles/hippolytej/cjgnojfg700a02rp30bjdees6"}},79:function(e,t,r){e.exports=r(205)},84:function(e,t,r){}},[[79,2,1]]]);
//# sourceMappingURL=main.1748ea99.chunk.js.map